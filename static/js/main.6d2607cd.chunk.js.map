{"version":3,"sources":["pkce.ts","icons.ts","components/data/BlindTestData.ts","components/data/SettingsData.ts","helpers.ts","services/axios.ts","components/Login.tsx","services/SpotifyAPI.ts","components/Settings.tsx","components/data/PlaylistsData.ts","components/data/TracksBaseData.ts","components/PlaylistRow.tsx","components/Paginator.tsx","components/PlaylistTable.tsx","components/PlaylistsButton.tsx","components/LogoutButton.tsx","components/SettingsButton.tsx","components/BlindTestView.tsx","components/LoginCallback.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["PKCECodePair","cv","cc","codeVerifier","codeChallenge","this","base64URLEncode","str","toString","replace","createPKCECodes","buffer","randomBytes","Buffer","from","createHash","update","digest","library","add","fab","faEye","faComment","faMinus","faPlus","faQuestion","faVolumeMute","faCheck","faList","faStepForward","faPause","faPlay","faMusic","faPlayCircle","faCog","faSearch","faTimes","faSignOutAlt","faCheckCircle","faTimesCircle","Guessable","original","toGuess","maxDistance","BlindTestTrack","title","artists","uri","offset","img","BlindTestTracks","spotTracks","tracks","doneTracks","t","track","map","a","name","cleanSpoiler","push","computeGuessable","album","track_number","images","url","value","cleaned","cleanValue","maxDist","getMaxDist","SettingsData","twitchChannel","deviceId","addEveryUser","chatNotifications","undefined","getParam","results","RegExp","exec","decodeURIComponent","getTwitchOAuthToken","console","log","localStorage","getItem","getRefreshToken","setRefreshToken","refresh_token","setItem","setAccessToken","access_token","removeAccessToken","removeItem","getSettings","deserialize","getBlindTestScores","Map","Object","entries","JSON","parse","removeBlindTestScores","removeBlindTestTracks","setBlindTestTracks","data","serialize","cleanValueLight","replaceAll","trim","toLowerCase","normalize","artist","regExp","Math","floor","max","length","computeDistance","source","target","sourceLength","targetLength","dist","Array","i","fill","j","cost","charAt","min","instance","axios","create","headers","axiosErrorCallback","interceptors","response","use","res","err","config","status","_retry","defaults","common","Authorization","params","URLSearchParams","append","process","post","rs","accessToken","displayError","Promise","reject","stringify","retrieveAccessToken","access_code","pkcePair","codePair","consumePkcePair","Login","setSubtitle","useContext","BlindTestContext","useEffect","Button","id","type","variant","size","onClick","computePkcePair","window","location","href","icon","getPlaylists","limit","get","getPlaylistTracks","playlist_id","setRepeatMode","enabled","device_id","put","Settings","setConfigured","navigate","useNavigate","useState","settings","validated","setValidated","initialized","setInitialized","devices","setDevices","selectedDevice","setSelectedDevice","loggedInTwitch","setLoggedInTwitch","setChatNotifications","setAddEveryUser","channel","setChannel","twitchLoginURI","URL","origin","twitch_oauth_token","token","hash","then","found","find","d","style","width","margin","Form","noValidate","onSubmit","e","preventDefault","stopPropagation","currentTarget","checkValidity","Group","className","controlId","Label","Control","required","onChange","placeholder","Select","Check","disabled","checked","label","Text","muted","PlaylistsData","PLAYLIST_LIMIT","SEARCH_LIMIT","dataInitialized","loadSlice","start","end","slice","query","loadAll","filter","p","includes","loadedData","playlistsResponse","playlistsData","total","splice","items","TracksBaseData","playlist","playlistItems","getPlaylistItems","PlaylistRow","props","setOngoingBt","confirmationDisplayed","setConfirmationDisplayed","selectPlaylist","loadPlaylist","keepScores","bt","renderTickCross","condition","color","MusicIcon","colSpan","public","Alert","owner","display_name","Paginator","currentPage","onPageChanged","ceil","totalRecords","pageLimit","PlaylistTable","PAGE_SIZE","searchSubmitted","setSearchSubmitted","setQuery","playlists","setPlaylists","playlistCount","setPlaylistCount","setCurrentPage","loadCurrentPlaylistPage","playlistSearch","playlistSearchCancel","search","count","handlePageChanged","page","InputGroup","FormControl","role","onKeyDown","event","key","PlaylistsButton","LogoutButton","setLoggedIn","twitchClient","twitchCallback","BlindTestView","setDoneTracks","scores","setScores","nickFilter","setNickFilter","loading","setLoading","playing","setPlaying","paused","setPaused","guesses","setGuesses","guessables","setGuessables","coverUri","setCoverUri","chan","opts","channels","identity","username","password","Client","connect","on","_channel","_tags","_message","twitchConnection","disconnect","backupState","setBlindTestScores","nick","message","addPlayerIfUnknown","proposition","guessed","guessable","points","g","guessedBy","addPointToPlayer","updateGuessState","say","newScores","set","index","newGuesses","forEach","oldGuess","allGuessed","reduce","prev","curr","handleNextSong","album_uri","context_uri","position","catch","CrossEmoji","BubbleEmoji","CheckEmoji","GuessableView","guess","fontWeight","src","alt","display","flat","distinctScores","_val","_key","score","sort","b","localeCompare","s","rank","indexOf","computeFlatScores","sc","LoginCallback","code","App","loggedIn","isInitialized","configured","ongoingBt","view","setView","subtitle","errorMessage","setErrorMessage","contextValue","msg","Provider","Heading","right","SettingsButton","path","element","createContext","v","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","require","shim","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.6d2607cd.chunk.js","sourcesContent":["import { randomBytes, createHash } from 'crypto'\r\n\r\nexport class PKCECodePair {\r\n    codeVerifier: string\r\n    codeChallenge: string\r\n\r\n    constructor(cv: string, cc: string) {\r\n        this.codeVerifier = cv\r\n        this.codeChallenge = cc\r\n    }\r\n}\r\n\r\nexport const base64URLEncode = (str: Buffer): string => {\r\n    return str\r\n        .toString('base64')\r\n        .replace(/\\+/g, '-')\r\n        .replace(/\\//g, '_')\r\n        .replace(/=/g, '')\r\n}\r\n\r\nexport const sha256 = (buffer: Buffer): Buffer => {\r\n    return createHash('sha256').update(buffer).digest()\r\n}\r\n\r\nexport const createPKCECodes = (): PKCECodePair => {\r\n    const codeVerifier = base64URLEncode(randomBytes(64))\r\n    const codeChallenge = base64URLEncode(sha256(Buffer.from(codeVerifier)))\r\n    const codePair = new PKCECodePair(codeVerifier, codeChallenge)\r\n    return codePair\r\n}","import { library } from '@fortawesome/fontawesome-svg-core'\r\nimport { fab } from '@fortawesome/free-brands-svg-icons'\r\nimport { faComment, faCheckCircle, faTimesCircle } from '@fortawesome/free-regular-svg-icons'\r\nimport { faVolumeMute, faQuestion, faCheck, faMinus, faEye, faPlus, faMusic, faPlayCircle, faList, faStepForward, faPause, faPlay, faCog, faSearch, faTimes, faSignOutAlt } from '@fortawesome/free-solid-svg-icons'\r\n\r\nlibrary.add(\r\n  fab,\r\n  faEye,\r\n  faComment,\r\n  faMinus,\r\n  faPlus,\r\n  faQuestion,\r\n  faVolumeMute,\r\n  faCheck,\r\n  faList,\r\n  faStepForward,\r\n  faPause,\r\n  faPlay,\r\n  faMusic,\r\n  faPlayCircle,\r\n  faStepForward,\r\n  faCog,\r\n  faSearch,\r\n  faTimes,\r\n  faSignOutAlt,\r\n  faCheckCircle,\r\n  faTimesCircle\r\n)\r\n","import { cleanValue, cleanSpoiler, getMaxDist } from \"../../helpers\"\r\n\r\nexport class Guessable {\r\n    original: string\r\n    toGuess: string\r\n    maxDistance: number\r\n\r\n    constructor(original: string, toGuess: string, maxDistance: number) {\r\n        this.original = original;\r\n        this.toGuess = toGuess;\r\n        this.maxDistance = maxDistance;\r\n    }\r\n}\r\n\r\nexport class BlindTestTrack {\r\n    title: Guessable\r\n    artists: Guessable[]\r\n    uri: string\r\n    img: string\r\n    offset: number\r\n\r\n    constructor(title: Guessable, artists: Guessable[], uri: string, offset: number, img: string) {\r\n        this.title = title;\r\n        this.artists = artists;\r\n        this.uri = uri;\r\n        this.offset = offset;\r\n        this.img = img;\r\n    }\r\n}\r\n\r\nexport class BlindTestTracks {\r\n    tracks: BlindTestTrack[] = []\r\n    doneTracks: number = 0\r\n\r\n    constructor(spotTracks: any[]) {\r\n        if (spotTracks) {\r\n            for (let spotTrack of spotTracks) {\r\n                let t = spotTrack.track;\r\n                let artists = t.artists.map((a: any) => a.name);\r\n                let title = cleanSpoiler(t.name, artists);\r\n                this.tracks.push(new BlindTestTrack(\r\n                    computeGuessable(title),\r\n                    t.artists.map((a: { name: string }) => computeGuessable(a.name)),\r\n                    t.album.uri,\r\n                    t.track_number - 1,\r\n                    t.album.images[1].url\r\n                ));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst computeGuessable = (value: string) => {\r\n    let cleaned = cleanValue(value);\r\n    let maxDist = getMaxDist(cleaned);\r\n    return new Guessable(value, cleaned, maxDist);\r\n}\r\n","export class SettingsData {\r\n    twitchChannel: string\r\n    deviceId: string\r\n    addEveryUser: boolean\r\n    chatNotifications: boolean\r\n\r\n    constructor(twitchChannel: string, deviceId: string, addEveryUser: boolean, chatNotifications: boolean) {\r\n        this.twitchChannel = twitchChannel\r\n        this.deviceId = deviceId\r\n        this.addEveryUser = addEveryUser\r\n        this.chatNotifications = chatNotifications\r\n    }\r\n\r\n    isInitialized(): boolean {\r\n        return this.twitchChannel !== undefined && this.deviceId !== undefined;\r\n    }\r\n}\r\n","import { BlindTestTracks } from \"components/data/BlindTestData\"\r\nimport { deserialize, serialize } from 'class-transformer'\r\nimport { createPKCECodes, PKCECodePair } from 'pkce'\r\nimport { SettingsData } from \"components/data/SettingsData\"\r\n\r\nexport const getAppHomeURL = () => {\r\n  return new URL(window.location.href).origin\r\n}\r\n\r\nexport const getQueryParam = (name: string) => {\r\n  return getParam(name, window.location.search);\r\n}\r\n\r\nexport const getHashParam = (name: string) => {\r\n  return getParam(name, window.location.hash);\r\n}\r\n\r\nconst getParam = (name: string, value: string) => {\r\n  name = name.replace(/[[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\")\r\n  var regex = new RegExp(\"[\\\\?&#]\" + name + \"=([^&#]*)\"),\r\n    results = regex.exec(value)\r\n  return results === null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"))\r\n}\r\n\r\nexport const computePkcePair = () => {\r\n  const codePair: PKCECodePair = createPKCECodes()\r\n  localStorage.setItem(\"pkce_pair\", serialize(codePair))\r\n  return codePair\r\n}\r\n\r\nexport const consumePkcePair = () => {\r\n  const codePair: PKCECodePair = deserialize(PKCECodePair, localStorage.getItem(\"pkce_pair\") || \"{}\")\r\n  localStorage.removeItem(\"pkce_pair\")\r\n  return codePair\r\n}\r\n\r\nexport const getTwitchOAuthToken = () => {\r\n  console.log(\"getTwitchOAuthToken\");\r\n  return localStorage.getItem(\"twitch_oauth_token\");\r\n}\r\n\r\nexport const setTwitchOAuthToken = (twitch_oauth_token: any) => {\r\n  localStorage.setItem(\"twitch_oauth_token\", twitch_oauth_token)\r\n}\r\n\r\nexport const removeTwitchOAuthToken = () => {\r\n  localStorage.removeItem(\"twitch_oauth_token\")\r\n}\r\n\r\nexport const getRefreshToken = () => {\r\n  return localStorage.getItem(\"refresh_token\")\r\n}\r\n\r\nexport const setRefreshToken = (refresh_token: any) => {\r\n  localStorage.setItem(\"refresh_token\", refresh_token)\r\n}\r\n\r\nexport const removeRefreshToken = () => {\r\n  localStorage.removeItem(\"refresh_token\")\r\n}\r\n\r\nexport const getAccessToken = () => {\r\n  return localStorage.getItem(\"access_token\")\r\n}\r\n\r\nexport const setAccessToken = (access_token: any) => {\r\n  localStorage.setItem(\"access_token\", access_token)\r\n}\r\n\r\nexport const removeAccessToken = () => {\r\n  localStorage.removeItem(\"access_token\")\r\n}\r\n\r\nexport const hasStoredBlindTest = () => {\r\n  return localStorage.getItem(\"blind_test_tracks\") !== null\r\n}\r\n\r\nexport const getSettings = () => {\r\n  return deserialize(SettingsData, localStorage.getItem(\"settings\") || \"{}\")\r\n}\r\n\r\nexport const removeSettings = () => {\r\n  localStorage.removeItem(\"settings\")\r\n}\r\n\r\nexport const setSettings = (data: SettingsData) => {\r\n  localStorage.setItem(\"settings\", serialize(data))\r\n}\r\n\r\nexport const getBlindTestScores = () => {\r\n  // ugly workaround because class-transformer deserialize maps to plain objects ...\r\n  let scores: Map<string, number> = new Map(Object.entries(JSON.parse(localStorage.getItem(\"blind_test_scores\") || \"{}\")));\r\n  return scores;\r\n}\r\n\r\nexport const removeBlindTestScores = () => {\r\n  localStorage.removeItem(\"blind_test_scores\")\r\n}\r\n\r\nexport const setBlindTestScores = (scores: Map<string, number>) => {\r\n  localStorage.setItem(\"blind_test_scores\", serialize(scores));\r\n}\r\n\r\nexport const getBlindTestTracks = () => {\r\n  let bt = deserialize(BlindTestTracks, localStorage.getItem(\"blind_test_tracks\") || \"{}\")\r\n  return bt\r\n}\r\n\r\nexport const removeBlindTestTracks = () => {\r\n  localStorage.removeItem(\"blind_test_tracks\")\r\n}\r\n\r\nexport const setBlindTestTracks = (data: BlindTestTracks) => {\r\n  localStorage.setItem(\"blind_test_tracks\", serialize(data))\r\n}\r\n\r\n// light clean + trailing parts (- X || (X))\r\nexport const cleanValue = (value: string) => {\r\n  return cleanValueLight(value).replaceAll(/ \\(.+\\).*| -.+/g, \"\").trim()\r\n}\r\n\r\n// lower-case + remove diacritic + remove some special characters\r\nexport const cleanValueLight = (value: string) => {\r\n  return value.toLowerCase().normalize(\"NFD\").replaceAll(/\\p{Diacritic}/gu, \"\").replaceAll(/[,!?:;.]/g, \"\").replaceAll(\"’\", \"'\").trim()\r\n}\r\n\r\nexport const cleanSpoiler = (title: string, artists: string[]) => {\r\n  let cleaned = title;\r\n  for (let artist of artists) {\r\n    var regExp = new RegExp(` \\\\(.*${artist}.*\\\\)| \\\\[.*${artist}.*\\\\]| - .*${artist}.*`, \"gi\");\r\n    cleaned = cleaned.replaceAll(regExp, \"\").trim();\r\n  }\r\n  return cleaned;\r\n}\r\n\r\nexport const getMaxDist = (value: string) => {\r\n  return Math.floor(Math.max(0, value.length - 3) / 6);\r\n}\r\n\r\nexport const computeDistance = (source: string, target: string) => {\r\n  const sourceLength: number = source.length\r\n  const targetLength: number = target.length\r\n  if (sourceLength === 0) return targetLength\r\n  if (targetLength === 0) return sourceLength\r\n\r\n  const dist = new Array<number[]>(sourceLength + 1)\r\n  for (let i = 0; i <= sourceLength; ++i) {\r\n    dist[i] = new Array<number>(targetLength + 1).fill(0)\r\n  }\r\n\r\n  for (let i = 0; i < sourceLength + 1; i++) {\r\n    dist[i][0] = i\r\n  }\r\n  for (let j = 0; j < targetLength + 1; j++) {\r\n    dist[0][j] = j\r\n  }\r\n  for (let i = 1; i < sourceLength + 1; i++) {\r\n    for (let j = 1; j < targetLength + 1; j++) {\r\n      let cost = source.charAt(i - 1) === target.charAt(j - 1) ? 0 : 1\r\n\r\n      // special cases\r\n      if (source.charAt(i - 1) === ' ' && (target.charAt(j - 1) === '-' || target.charAt(j - 1) === '\\'')) cost = 0\r\n\r\n      dist[i][j] = Math.min(dist[i - 1][j] + 1, dist[i][j - 1] + 1, dist[i - 1][j - 1] + cost)\r\n      if (i > 1 &&\r\n        j > 1 &&\r\n        source.charAt(i - 1) === target.charAt(j - 2) &&\r\n        source.charAt(i - 2) === target.charAt(j - 1)) {\r\n        dist[i][j] = Math.min(dist[i][j], dist[i - 2][j - 2] + cost)\r\n      }\r\n    }\r\n  }\r\n  return dist[sourceLength][targetLength]\r\n}","import axios from 'axios';\r\nimport { getRefreshToken, setRefreshToken, removeAccessToken, getAccessToken, setAccessToken, consumePkcePair } from 'helpers';\r\n\r\nconst instance = axios.create({\r\n    headers: {\r\n        \"Content-Type\": \"application/json\",\r\n    }\r\n});\r\n\r\nlet axiosErrorCallback: (msg: string) => void = () => { };\r\n\r\nexport const setAxiosErrorCallback = (callback: (msg: string) => void) => {\r\n    axiosErrorCallback = callback;\r\n}\r\n\r\ninstance.interceptors.response.use(\r\n    (res) => {\r\n        return res\r\n    },\r\n    async (err) => {\r\n        const config = err.config\r\n\r\n        if (err.response) {\r\n            // Access Token was expired\r\n            if (err.response.status === 401 && !config._retry) {\r\n                delete instance.defaults.headers.common.Authorization\r\n                removeAccessToken()\r\n                config._retry = true\r\n                try {\r\n                    const params = new URLSearchParams()\r\n                    params.append('grant_type', 'refresh_token')\r\n                    params.append('refresh_token', getRefreshToken() || \"\")\r\n                    params.append('client_id', process.env.REACT_APP_SPOTIFY_CLIENT_ID || \"\")\r\n                    const rs = await instance.post('https://accounts.spotify.com/api/token',\r\n                        params, {\r\n                        headers: {\r\n                            \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n                        }\r\n                    })\r\n                    setRefreshToken(rs.data.refresh_token)\r\n                    const accessToken = rs.data.access_token\r\n                    setAccessToken(accessToken)\r\n                    instance.defaults.headers.common.Authorization = `Bearer ${accessToken}`\r\n                    config.headers.Authorization = `Bearer ${accessToken}`\r\n                    return instance(config)\r\n                } catch (_error) {\r\n                    displayError(err);\r\n                    return Promise.reject(_error)\r\n                }\r\n            }\r\n            displayError(err);\r\n        }\r\n        return Promise.reject(err);\r\n    }\r\n)\r\n\r\nconst displayError = (err: any) => {\r\n    axiosErrorCallback(err.response.status + (err.response.data && (' ' + JSON.stringify(err.response.data))));\r\n}\r\n\r\nexport const retrieveAccessToken = (access_code: string) => {\r\n    const params = new URLSearchParams()\r\n    const pkcePair = consumePkcePair()\r\n    params.append('code', access_code)\r\n    params.append('redirect_uri', process.env.PUBLIC_URL + \"/callback\")\r\n    params.append('grant_type', 'authorization_code')\r\n    params.append('code_verifier', pkcePair.codeVerifier)\r\n    params.append('client_id', process.env.REACT_APP_SPOTIFY_CLIENT_ID || \"\")\r\n\r\n    return instance.post('https://accounts.spotify.com/api/token',\r\n        params, {\r\n        headers: {\r\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n        }\r\n    })\r\n}\r\n\r\nconst accessToken = getAccessToken()\r\nif (accessToken) {\r\n    instance.defaults.headers.common.Authorization = `Bearer ${accessToken}`\r\n}\r\n\r\nexport default instance;","import { Button } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { computePkcePair } from \"../helpers\"\r\nimport { useContext, useEffect } from \"react\";\r\nimport { BlindTestContext } from \"App\";\r\n\r\nconst Login = () => {\r\n\r\n  const { setSubtitle } = useContext(BlindTestContext);\r\n\r\n  useEffect(() => {\r\n    console.log(`process.env.PUBLIC_URL = ${process.env.PUBLIC_URL}`)\r\n    setSubtitle('Play Blind-Test on Twitch !');\r\n  }, [setSubtitle]);\r\n\r\n  const authorize = () => {\r\n    const pkcePair = computePkcePair()\r\n    window.location.href = \"https://accounts.spotify.com/authorize\" +\r\n      \"?client_id=\" + process.env.REACT_APP_SPOTIFY_CLIENT_ID +\r\n      \"&redirect_uri=\" + process.env.PUBLIC_URL + \"/callback\" +\r\n      \"&scope=playlist-read-private%20user-modify-playback-state%20user-read-playback-state\" +\r\n      \"&response_type=code\" +\r\n      \"&code_challenge_method=S256\" +\r\n      \"&code_challenge=\" + pkcePair.codeChallenge +\r\n      \"&show_dialog=true\";\r\n  }\r\n\r\n  return (\r\n    <Button id=\"loginButton\" type=\"submit\" variant=\"outline-secondary\" size=\"lg\" onClick={authorize}>\r\n      <FontAwesomeIcon icon={['far', 'check-circle']} size=\"sm\" /> Login with Spotify\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport default Login\r\n","import instance from \"./axios\";\r\n\r\nexport const getPlaylists = (offset: number, limit: number) => {\r\n    return instance.get(`https://api.spotify.com/v1/me/playlists?offset=${offset}&limit=${limit}`)\r\n}\r\n\r\nexport const getPlaylistTracks = (playlist_id: string, offset: number, limit: number) => {\r\n    return instance.get(`https://api.spotify.com/v1/playlists/${playlist_id}/tracks?offset=${offset}&limit=${limit}&fields=items(track(track_number,name,artists(name),album(uri,images)))`)\r\n}\r\n\r\nexport const setRepeatMode = (enabled: boolean, device_id: string) => {\r\n    return instance.put(`https://api.spotify.com/v1/me/player/repeat?device_id=${device_id}&state=${enabled ? 'track' : 'off'}`)\r\n}\r\n\r\nexport const launchTrack = (album_uri: string, offset: number, device_id: string) => {\r\n    return instance.put(`https://api.spotify.com/v1/me/player/play?device_id=${device_id}`, {\r\n        context_uri: album_uri,\r\n        offset: {\r\n            position: offset\r\n        }\r\n    })\r\n}\r\n\r\nexport const getDevices = () => {\r\n    return instance.get(`https://api.spotify.com/v1/me/player/devices`)\r\n}\r\n\r\nexport const pausePlayer = (device_id: string) => {\r\n    return instance.put(`https://api.spotify.com/v1/me/player/pause?device_id=${device_id}`)\r\n}\r\n\r\nexport const resumePlayer = (device_id: string) => {\r\n    return instance.put(`https://api.spotify.com/v1/me/player/play?device_id=${device_id}`)\r\n}","import { getSettings, getTwitchOAuthToken, setSettings, getAppHomeURL, setTwitchOAuthToken, getHashParam, removeTwitchOAuthToken } from \"helpers\"\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useContext, useEffect, useState } from 'react'\r\nimport { getDevices } from \"services/SpotifyAPI\"\r\nimport { SettingsData } from \"./data/SettingsData\";\r\nimport Form from 'react-bootstrap/Form'\r\nimport { Button } from \"react-bootstrap\";\r\nimport { BlindTestContext } from \"App\";\r\n\r\nconst Settings = () => {\r\n\r\n  const { setConfigured, setSubtitle } = useContext(BlindTestContext);\r\n  const navigate = useNavigate();\r\n\r\n  const [settings] = useState(() => getSettings());\r\n  const [validated, setValidated] = useState(false);\r\n  const [initialized, setInitialized] = useState(false);\r\n  const [devices, setDevices] = useState<any[]>([]);\r\n  const [selectedDevice, setSelectedDevice] = useState<string>('');\r\n  const [loggedInTwitch, setLoggedInTwitch] = useState<boolean>(() => getTwitchOAuthToken() !== null);\r\n  const [chatNotifications, setChatNotifications] = useState<boolean>(settings.chatNotifications || false);\r\n  const [addEveryUser, setAddEveryUser] = useState<boolean>(settings.addEveryUser || false);\r\n  const [channel, setChannel] = useState(settings.twitchChannel || '');\r\n\r\n  const twitchLoginURI = \"https://id.twitch.tv/oauth2/authorize\" +\r\n    \"?client_id=\" + process.env.REACT_APP_TWITCH_CLIENT_ID +\r\n    \"&redirect_uri=\" + getAppHomeURL() + \"/settings\" +\r\n    \"&scope=chat:read+chat:edit+channel:moderate+whispers:read+whispers:edit+channel_editor\" +\r\n    \"&response_type=token\";\r\n\r\n  useEffect(() => {\r\n    console.log(\"main useEffect\");\r\n    // Twitch logging callback\r\n    const token = getHashParam('access_token')\r\n    if (token) {\r\n      setTwitchOAuthToken(token);\r\n      setLoggedInTwitch(true);\r\n      navigate(\"/settings\");\r\n    }\r\n\r\n    setSubtitle('Settings');\r\n    getDevices().then(response => {\r\n      setDevices(response.data.devices);\r\n      const found = response.data.devices.find((d: any) => d.id === settings.deviceId)\r\n      if (found) {\r\n        setSelectedDevice(found.id)\r\n      }\r\n      setInitialized(true);\r\n    })\r\n  }, []);\r\n\r\n  const twitchLogout = () => {\r\n    removeTwitchOAuthToken();\r\n    setLoggedInTwitch(false);\r\n  }\r\n\r\n  const submit = (e: any) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.currentTarget.checkValidity() === true) {\r\n      setSettings(new SettingsData(channel, selectedDevice, addEveryUser, chatNotifications));\r\n      setConfigured(true);\r\n      navigate(\"/\");\r\n    }\r\n    setValidated(true);\r\n  }\r\n\r\n  if (initialized) {\r\n    return (\r\n      <div style={{ width: '600px', margin: 'auto' }}>\r\n        <Form noValidate validated={validated} onSubmit={submit}>\r\n          <Form.Group className=\"mb-3\" controlId=\"formGroupTwitch\">\r\n            <Form.Label>Twitch channel</Form.Label>\r\n            <Form.Control required value={channel} onChange={(e) => { setChannel(e.target.value) }} type=\"text\" placeholder=\"Enter twitch channel\" />\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"formGroupDevice\">\r\n            <Form.Label>Playing device</Form.Label>\r\n            <Form.Select required className=\"form-control\" value={selectedDevice} onChange={(e) => { setSelectedDevice(e.target.value) }}>\r\n              <option value=\"\">Select device...</option>\r\n              {devices.map((d) => <option key={d.id} value={d.id}>{d.name} ({d.type})</option>)}\r\n            </Form.Select>\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"formGroupChatNotifications\">\r\n            <Form.Check disabled={!loggedInTwitch} type=\"checkbox\" checked={loggedInTwitch && chatNotifications} label=\"Display guess notifications in the chat\" onChange={(e) => { setChatNotifications(e.target.checked) }} />\r\n            {process.env.REACT_APP_TWITCH_CLIENT_ID &&\r\n              <>\r\n                {!loggedInTwitch &&\r\n                  <Form.Text id=\"twitchLoginBlock\" muted>\r\n                    You need to log in to twitch to use that feature. <a href={twitchLoginURI}>Click here to log in</a>\r\n                  </Form.Text>\r\n                }\r\n                {loggedInTwitch &&\r\n                  <Form.Text id=\"twitchLogoutBlock\" onClick={twitchLogout} muted>\r\n                    <a href=\"#\">Log out from twitch</a>\r\n                  </Form.Text>\r\n                }\r\n              </>\r\n            }\r\n          </Form.Group>\r\n          <Form.Group className=\"mb-3\" controlId=\"formGroupAddEveryUser\">\r\n            <Form.Check type=\"checkbox\" checked={addEveryUser} label=\"Add every speaking viewer in the leaderboard\" onChange={(e) => { setAddEveryUser(e.target.checked) }} />\r\n          </Form.Group>\r\n          <Button variant=\"primary\" type=\"submit\">\r\n            Save\r\n          </Button>\r\n        </Form>\r\n      </div>\r\n    )\r\n  } else {\r\n    return <div className=\"spinner\"></div>\r\n  }\r\n}\r\n\r\nexport default Settings\r\n","import { getPlaylists } from \"services/SpotifyAPI\"\r\n\r\n// Handles cached loading of all or subsets of playlist data\r\nclass PlaylistsData {\r\n  PLAYLIST_LIMIT = 50\r\n  SEARCH_LIMIT = 20\r\n\r\n  data: any[]\r\n  dataInitialized = false\r\n\r\n  constructor() {\r\n    this.data = []\r\n  }\r\n\r\n  async total() {\r\n    if (!this.dataInitialized) {\r\n      await this.loadSlice()\r\n    }\r\n\r\n    return this.data.length\r\n  }\r\n\r\n  async slice(start: number, end: number) {\r\n    await this.loadSlice(start, end)\r\n    return this.data.slice(start, end)\r\n  }\r\n\r\n  async search(query: string) {\r\n    await this.loadAll()\r\n    // Case-insensitive search in playlist name\r\n    return this.data\r\n      .filter(p => p.name.toLowerCase().includes(query.toLowerCase()))\r\n      .slice(0, this.SEARCH_LIMIT)\r\n  }\r\n\r\n  async loadAll() {\r\n    await this.loadSlice()\r\n\r\n    // Get the rest of them if necessary\r\n    for (var offset = this.PLAYLIST_LIMIT; offset < this.data.length; offset = offset + this.PLAYLIST_LIMIT) {\r\n      await this.loadSlice(offset, offset + this.PLAYLIST_LIMIT)\r\n    }\r\n  }\r\n\r\n  async loadSlice(start = 0, end = start + this.PLAYLIST_LIMIT) {\r\n    if (this.dataInitialized) {\r\n      const loadedData = this.data.slice(start, end)\r\n\r\n      if (loadedData.filter(i => !i).length === 0) {\r\n        return loadedData\r\n      }\r\n    }\r\n\r\n    const playlistsResponse = await getPlaylists(start, this.PLAYLIST_LIMIT)\r\n    if (playlistsResponse.status !== 200) return;\r\n    const playlistsData = playlistsResponse.data\r\n\r\n    if (!this.dataInitialized) {\r\n      this.data = Array(playlistsData.total).fill(null)\r\n      this.dataInitialized = true\r\n    }\r\n\r\n    this.data.splice(start, playlistsData.items.length, ...playlistsData.items)\r\n  }\r\n}\r\n\r\nexport default PlaylistsData\r\n","import { getPlaylistTracks } from \"services/SpotifyAPI\"\r\n\r\nclass TracksBaseData {\r\n  playlist: any\r\n\r\n  constructor(playlist: any) {\r\n    this.playlist = playlist\r\n  }\r\n\r\n  async trackItems() {\r\n    await this.getPlaylistItems()\r\n    return this.playlistItems\r\n  }\r\n\r\n  // Memoization supporting multiple calls\r\n  playlistItems: any[] = []\r\n  async getPlaylistItems() {\r\n    if (this.playlistItems.length === 0) {\r\n      var limit = 100\r\n      for (var offset = 0; offset < this.playlist.tracks.total; offset = offset + limit) {\r\n        const tracks = await getPlaylistTracks(this.playlist.id, offset, limit)\r\n        if (tracks) this.playlistItems.push(...tracks.data.items.filter((i: any) => i.track))\r\n      }\r\n    }\r\n\r\n    return this.playlistItems\r\n  }\r\n}\r\n\r\nexport default TracksBaseData\r\n","import TracksBaseData from \"./data/TracksBaseData\"\r\nimport { Button, Alert } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { BlindTestTracks } from \"./data/BlindTestData\"\r\nimport { setBlindTestTracks, removeBlindTestScores, getBlindTestScores } from \"../helpers\"\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useContext, useState } from \"react\"\r\nimport { BlindTestContext } from \"App\"\r\n\r\nconst PlaylistRow = (props: any) => {\r\n\r\n  const { setOngoingBt } = useContext(BlindTestContext);\r\n  const [confirmationDisplayed, setConfirmationDisplayed] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const selectPlaylist = async () => {\r\n    if (getBlindTestScores().size > 0) {\r\n      setConfirmationDisplayed(true);\r\n    } else {\r\n      loadPlaylist(false);\r\n    }\r\n  }\r\n\r\n  const loadPlaylist = async (keepScores: boolean) => {\r\n    if (!keepScores) {\r\n      removeBlindTestScores();\r\n    }\r\n    const tracks = await new TracksBaseData(props.playlist).getPlaylistItems();\r\n    const bt = new BlindTestTracks(tracks);\r\n    setBlindTestTracks(bt);\r\n    setOngoingBt(true);\r\n    navigate(\"/\");\r\n  }\r\n\r\n  const renderTickCross = (condition: boolean) => {\r\n    if (condition) {\r\n      return <FontAwesomeIcon icon={['far', 'check-circle']} size=\"sm\" />\r\n    } else {\r\n      return <FontAwesomeIcon icon={['far', 'times-circle']} size=\"sm\" style={{ color: '#ECEBE8' }} />\r\n    }\r\n  };\r\n\r\n  const MusicIcon = <FontAwesomeIcon icon={['fas', 'music']} />;\r\n\r\n  let playlist = props.playlist;\r\n\r\n  if (playlist.uri == null) return (\r\n    <tr key={playlist.name}>\r\n      <td>{MusicIcon}</td>\r\n      <td>{playlist.name}</td>\r\n      <td colSpan={2}>This playlist is not supported</td>\r\n      <td>{renderTickCross(playlist.public)}</td>\r\n      <td>&nbsp;</td>\r\n    </tr>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {confirmationDisplayed &&\r\n        <div className=\"spot-modal-bg\">\r\n          <Alert className=\"spot-modal\" variant=\"secondary\" >\r\n            <p>\r\n              Do you want to reset the leaderboard scores ?\r\n            </p>\r\n            <div className=\"d-flex justify-content-center\">\r\n              <Button className=\"mr-2\" onClick={() => loadPlaylist(false)} >\r\n                Yes\r\n              </Button>\r\n              <Button className=\"mr-2\" onClick={() => loadPlaylist(true)} variant=\"danger\">\r\n                No\r\n              </Button>\r\n              <Button onClick={() => setConfirmationDisplayed(false)} variant=\"secondary\">\r\n                Cancel\r\n              </Button>\r\n            </div>\r\n          </Alert>\r\n        </div>\r\n      }\r\n      <tr key={playlist.uri}>\r\n        <td>{MusicIcon}</td>\r\n        <td><a href={playlist.uri}>{playlist.name}</a></td>\r\n        <td><a href={playlist.owner.uri}>{playlist.owner.display_name}</a></td>\r\n        <td>{playlist.tracks.total}</td>\r\n        <td>{renderTickCross(playlist.public)}</td>\r\n        <td className=\"text-right\">\r\n          <Button type=\"submit\" variant=\"primary\" onClick={selectPlaylist} className=\"text-nowrap btn-xs\">\r\n            <FontAwesomeIcon icon={['fas', 'play-circle']} size=\"sm\" /> Select\r\n          </Button>\r\n        </td>\r\n      </tr>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PlaylistRow\r\n","const Paginator = (props: any) => {\r\n\r\n  const nextClick = (e: any) => {\r\n    e.preventDefault()\r\n    props.onPageChanged(props.currentPage + 1);\r\n  }\r\n\r\n  const prevClick = (e: any) => {\r\n    e.preventDefault()\r\n    props.onPageChanged(props.currentPage - 1);\r\n  }\r\n\r\n  const totalPages = () => {\r\n    return Math.ceil(props.totalRecords / props.pageLimit);\r\n  }\r\n\r\n  return (\r\n    <nav className=\"paginator text-right\">\r\n      <ul className=\"pagination pagination-sm\">\r\n        <li className={props.currentPage <= 1 ? 'page-item disabled' : 'page-item'}>\r\n          { /* eslint-disable-next-line  */}\r\n          <a className=\"page-link\" href=\"#\" aria-label=\"Previous\" onClick={prevClick}>\r\n            <span aria-hidden=\"true\">&laquo;</span>\r\n          </a>\r\n        </li>\r\n        <li className={props.currentPage >= totalPages() ? 'page-item disabled' : 'page-item'}>\r\n          { /* eslint-disable-next-line  */}\r\n          <a className=\"page-link\" href=\"#\" aria-label=\"Next\" onClick={nextClick}>\r\n            <span aria-hidden=\"true\">&raquo;</span>\r\n          </a>\r\n        </li>\r\n      </ul>\r\n    </nav>\r\n  )\r\n}\r\n\r\nexport default Paginator\r\n","import './PlaylistTable.scss'\r\n\r\nimport { useContext, useEffect, useState } from 'react'\r\nimport { FormControl, Form, InputGroup } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\n\r\nimport PlaylistsData from \"./data/PlaylistsData\"\r\nimport PlaylistRow from \"./PlaylistRow\"\r\nimport Paginator from \"./Paginator\"\r\nimport { BlindTestContext } from 'App'\r\n\r\nconst PlaylistTable = () => {\r\n  const PAGE_SIZE = 20;\r\n  const playlistsData = new PlaylistsData(); // TODO put cache in state\r\n\r\n  const { setSubtitle } = useContext(BlindTestContext);\r\n  \r\n  const [searchSubmitted, setSearchSubmitted] = useState(false);\r\n  const [query, setQuery] = useState(\"\");\r\n  const [initialized, setInitialized] = useState(false);\r\n  const [playlists, setPlaylists] = useState<any[]>([]);\r\n  const [playlistCount, setPlaylistCount] = useState(0);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n\r\n  useEffect(() => {\r\n    const min = ((currentPage - 1) * PAGE_SIZE) + 1;\r\n    const max = Math.min(min + PAGE_SIZE - 1, playlistCount);\r\n    setSubtitle(`${min}-${max} of ${playlistCount} playlists`);\r\n  }, [setSubtitle, currentPage, playlistCount]);\r\n\r\n  useEffect(() => {\r\n    loadCurrentPlaylistPage();\r\n  }, [currentPage]);\r\n\r\n  const playlistSearch = async () => {\r\n    if (query.length === 0) {\r\n      playlistSearchCancel()\r\n    } else {\r\n      setSearchSubmitted(true);\r\n      const playlists = await playlistsData.search(query)\r\n      setPlaylists(playlists);\r\n      setPlaylistCount(playlists.length);\r\n      setCurrentPage(1);\r\n\r\n      if (playlists.length === playlistsData.SEARCH_LIMIT) {\r\n        setSubtitle(`First ${playlists.length} results with \"${query}\" in playlist name`)\r\n      } else {\r\n        setSubtitle(`${playlists.length} results with \"${query}\" in playlist name`)\r\n      }\r\n    }\r\n  }\r\n\r\n  const playlistSearchCancel = () => {\r\n    setSearchSubmitted(false);\r\n    return loadCurrentPlaylistPage();\r\n  }\r\n\r\n  const loadCurrentPlaylistPage = async () => {\r\n    setQuery('');\r\n\r\n    const playlists = await playlistsData.slice(\r\n      ((currentPage - 1) * PAGE_SIZE),\r\n      ((currentPage - 1) * PAGE_SIZE) + PAGE_SIZE\r\n    )\r\n\r\n    setInitialized(true);\r\n    setPlaylists(playlists);\r\n\r\n    const count = await playlistsData.total();\r\n    setPlaylistCount(count);\r\n  }\r\n\r\n  const handlePageChanged = (page: number) => {\r\n    setCurrentPage(page);\r\n  }\r\n\r\n  const handleSearchKeyDown = (event: any) => {\r\n    event.stopPropagation()\r\n    if (event.key === 'Enter') {\r\n      playlistSearch()\r\n      event.preventDefault()\r\n    } else if (event.key === 'Escape') {\r\n      playlistSearchCancel()\r\n    }\r\n  }\r\n\r\n  if (initialized) {\r\n    const icon = (searchSubmitted)\r\n      ? <FontAwesomeIcon icon={['fas', 'times']} size=\"sm\" onClick={playlistSearchCancel} className=\"closeIcon\" />\r\n      : <FontAwesomeIcon icon={['fas', 'search']} size=\"sm\" onClick={playlistSearch} className=\"searchIcon\" />\r\n    const className = query.length > 0 ? \"search queryPresent\" : \"search\"\r\n\r\n    return (\r\n      <div id=\"playlists\">\r\n        <div id=\"playlistsHeader\">\r\n          <Paginator currentPage={currentPage} pageLimit={PAGE_SIZE} totalRecords={playlistCount} onPageChanged={handlePageChanged} />\r\n          <Form className={className}>\r\n            <InputGroup>\r\n              <FormControl value={query} type=\"text\" role=\"searchbox\" placeholder=\"Search\" size=\"sm\" onChange={(e) => setQuery(e.target.value)} onKeyDown={handleSearchKeyDown} className=\"border-right-0 border\"/>\r\n              <InputGroup.Text className=\"bg-transparent\">\r\n                {icon}\r\n              </InputGroup.Text>\r\n            </InputGroup>\r\n          </Form>\r\n        </div>\r\n        <table className=\"table table-hover table-sm\">\r\n          <thead>\r\n            <tr>\r\n              <th style={{ width: \"30px\" }}></th>\r\n              <th>Name</th>\r\n              <th style={{ width: \"150px\" }}>Owner</th>\r\n              <th style={{ width: \"100px\" }}>Tracks</th>\r\n              <th style={{ width: \"120px\" }}>Public?</th>\r\n              <th style={{ width: \"100px\" }}> </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {playlists.map((playlist) => {\r\n              return <PlaylistRow\r\n                playlist={playlist}\r\n                key={playlist.id}\r\n              />\r\n            })}\r\n          </tbody>\r\n        </table>\r\n        <div id=\"playlistsFooter\">\r\n          <Paginator currentPage={currentPage} pageLimit={PAGE_SIZE} totalRecords={playlistCount} onPageChanged={handlePageChanged} />\r\n        </div>\r\n      </div>\r\n    );\r\n  } else {\r\n    return <div className=\"spinner\"></div>\r\n  }\r\n}\r\n\r\nexport default PlaylistTable\r\n","import { Button } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { removeBlindTestTracks } from \"helpers\"\r\nimport { useContext } from \"react\";\r\nimport { BlindTestContext } from \"App\";\r\n\r\nconst PlaylistsButton = () => {\r\n\r\n  const { setOngoingBt } = useContext(BlindTestContext);\r\n\r\n  const handleClick = () => {\r\n    removeBlindTestTracks();\r\n    setOngoingBt(false);\r\n  }\r\n\r\n  return (\r\n    <Button id=\"listButton\" className=\"topButtons\" type=\"submit\" variant=\"link\" size=\"lg\" onClick={handleClick} title=\"Playlists\">\r\n      <FontAwesomeIcon icon={['fas', 'list']} size=\"lg\" />\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport default PlaylistsButton\r\n","import { Button } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { removeRefreshToken, removeAccessToken, removeBlindTestTracks, removeBlindTestScores, removeSettings } from \"helpers\"\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useContext } from \"react\";\r\nimport { BlindTestContext } from \"App\";\r\n\r\nconst LogoutButton = () => {\r\n\r\n  const { setLoggedIn, setOngoingBt, setConfigured } = useContext(BlindTestContext);\r\n  const navigate = useNavigate()\r\n\r\n  const handleClick = () => {\r\n    removeRefreshToken();\r\n    removeAccessToken();\r\n    removeBlindTestTracks();\r\n    removeBlindTestScores();\r\n    removeSettings();\r\n    setLoggedIn(false);\r\n    setOngoingBt(false);\r\n    setConfigured(false);\r\n    navigate(\"/\");\r\n  }\r\n\r\n  return (\r\n    <Button id=\"logoutButton\" className=\"topButtons\" type=\"submit\" variant=\"link\" size=\"lg\" onClick={handleClick} title=\"Logout\">\r\n      <FontAwesomeIcon icon={['fas', 'sign-out-alt']} size=\"lg\" />\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport default LogoutButton\r\n","import { Button } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst LogoutButton = () => {\r\n\r\n  const navigate = useNavigate()\r\n\r\n  const handleClick = () => {\r\n    navigate('/settings');\r\n  }\r\n\r\n  return (\r\n    <Button id=\"settingButton\" className=\"topButtons\" type=\"submit\" variant=\"link\" size=\"lg\" onClick={handleClick} title=\"Settings\">\r\n      <FontAwesomeIcon icon={['fas', 'cog']} size=\"lg\" />\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport default LogoutButton\r\n","import { getBlindTestTracks, getBlindTestScores, computeDistance, cleanValueLight, getSettings, setBlindTestTracks, setBlindTestScores, getTwitchOAuthToken } from \"helpers\"\r\nimport { useContext, useEffect, useState } from 'react'\r\nimport { launchTrack, pausePlayer, resumePlayer, setRepeatMode } from \"../services/SpotifyAPI\"\r\nimport { Button, FormControl } from \"react-bootstrap\"\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { Guessable } from \"./data/BlindTestData\"\r\nimport { Client, Options } from \"tmi.js\"\r\nimport { BlindTestContext } from \"App\"\r\n\r\ntype DisplayableScoreType = {\r\n  nick: string,\r\n  rank?: number,\r\n  score: number\r\n}\r\n\r\ntype GuessType = {\r\n  guessed: boolean,\r\n  guessedBy?: string,\r\n  points?: number\r\n}\r\n\r\nlet twitchClient: Client | null = null;\r\nlet twitchCallback: (nick: string, msg: string) => void = () => { };\r\n\r\nconst twitchConnection = (chan: string, chatNotifications: boolean) => {\r\n  let opts: Options = { channels: [chan] };\r\n  if (chatNotifications) {\r\n    opts.identity = {\r\n      username: 'foo',\r\n      password: getTwitchOAuthToken() || \"\"\r\n    }\r\n  }\r\n  twitchClient = new Client(opts);\r\n  twitchClient.connect();\r\n  twitchClient.on('message', (_channel: any, _tags: any, _message: any) => twitchCallback(_tags['display-name'], _message));\r\n}\r\n\r\nconst twitchDisconnection = () => {\r\n  if (twitchClient !== null) {\r\n    twitchClient.disconnect();\r\n  }\r\n}\r\n\r\nconst BlindTestView = () => {\r\n\r\n  const { setSubtitle } = useContext(BlindTestContext);\r\n\r\n  const [bt] = useState(() => getBlindTestTracks());\r\n  const [settings] = useState(() => getSettings());\r\n  const [doneTracks, setDoneTracks] = useState(bt.doneTracks);\r\n  const [scores, setScores] = useState(() => getBlindTestScores());\r\n  const [nickFilter, setNickFilter] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [playing, setPlaying] = useState(false);\r\n  const [paused, setPaused] = useState(false);\r\n  const [guesses, setGuesses] = useState<GuessType[]>([]);\r\n  const [guessables, setGuessables] = useState<Guessable[]>([]);\r\n  const [coverUri, setCoverUri] = useState('');\r\n\r\n  useEffect(() => {\r\n    twitchConnection(settings.twitchChannel, settings.chatNotifications);\r\n    return () => {\r\n      twitchDisconnection();\r\n    }\r\n  }, [settings.twitchChannel]);\r\n\r\n  useEffect(() => {\r\n    if (playing) {\r\n      setSubtitle(`Playing song #${doneTracks} out of ${bt.tracks.length}`)\r\n    } else if (bt.tracks.length - doneTracks > 0) {\r\n      setSubtitle(`${bt.tracks.length - doneTracks} tracks left`);\r\n    } else {\r\n      setSubtitle('Blind-test is finished !');\r\n    }\r\n  }, [setSubtitle, bt.tracks.length, playing, doneTracks]);\r\n\r\n  const backupState = () => {\r\n    bt.doneTracks = doneTracks;\r\n    setBlindTestTracks(bt);\r\n    setBlindTestScores(scores);\r\n  }\r\n\r\n  const onProposition = (nick: string, message: string) => {\r\n    addPlayerIfUnknown(nick);\r\n    if (playing) {\r\n      const proposition = cleanValueLight(message)\r\n      for (let i = 0; i < guessables.length; i++) {\r\n        const guess = guesses[i]\r\n        if (guess.guessed) continue\r\n        const guessable = guessables[i]\r\n        const d = computeDistance(proposition, guessable.toGuess)\r\n        if (d <= guessable.maxDistance || (proposition.includes(guessable.toGuess) && proposition.length <= 1.6 * guessable.toGuess.length)) {\r\n          const points = 1 + (guesses.find((g) => g.guessed && g.guessedBy === nick) ? 1 : 0);\r\n          addPointToPlayer(nick, points);\r\n          updateGuessState(i, nick, points);\r\n          twitchClient?.say(settings.twitchChannel, `✅ ${nick} correctly guessed [${guessable.toGuess}] +${points}`)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  twitchCallback = onProposition;\r\n\r\n  const addPlayerIfUnknown = (nick: string) => {\r\n    if (settings.addEveryUser && !scores.get(nick)) {\r\n      addPointToPlayer(nick, 0)\r\n    }\r\n  }\r\n\r\n  const addPointToPlayer = (nick: string, points: number) => {\r\n    let newScores: Map<string, number> = new Map(scores)\r\n    newScores.set(nick, (newScores.get(nick) || 0) + points)\r\n    setScores(newScores);\r\n  }\r\n\r\n  const updateGuessState = (index: number, nick: string, points: number) => {\r\n    let newGuesses = new Array<GuessType>()\r\n    guesses.forEach((oldGuess: GuessType, i: number) => {\r\n      if (i === index) {\r\n        newGuesses.push({ guessed: true, guessedBy: nick, points: points })\r\n      } else {\r\n        newGuesses.push({ guessed: oldGuess.guessed, guessedBy: oldGuess.guessedBy, points: oldGuess.points })\r\n      }\r\n    })\r\n    setGuesses(newGuesses);\r\n  }\r\n\r\n  const allGuessed = () => {\r\n    return playing && guesses.reduce((prev, curr) => prev && curr.guessed, true)\r\n  }\r\n\r\n  const handleReveal = () => {\r\n    backupState()\r\n    let newGuesses = new Array<GuessType>()\r\n    guesses.forEach((oldGuess: GuessType) => { newGuesses.push({ guessed: true, guessedBy: oldGuess.guessedBy, points: oldGuess.points }) })\r\n    setGuesses(newGuesses);\r\n  }\r\n\r\n  const handlePause = () => {\r\n    pausePlayer(settings.deviceId);\r\n    setPaused(true);\r\n  }\r\n\r\n  const handleResume = () => {\r\n    resumePlayer(settings.deviceId);\r\n    setPaused(false);\r\n  }\r\n\r\n  const handleNextSong = async () => {\r\n    backupState()\r\n    let track = bt.tracks[doneTracks]\r\n    setPlaying(false);\r\n    setLoading(true);\r\n    launchTrack(track.uri, track.offset, settings.deviceId).then(() => {\r\n      setRepeatMode(true, settings.deviceId);\r\n      setDoneTracks(doneTracks + 1);\r\n      setGuessables([track.title, ...track.artists]);\r\n      setGuesses(new Array(track.artists.length + 1).fill({ guessed: false }));\r\n      setCoverUri(track.img);\r\n      setPlaying(true);\r\n      setPaused(false);\r\n      setLoading(false);\r\n    }).catch(() => {\r\n      setLoading(false);\r\n    });\r\n  }\r\n\r\n  const CrossEmoji = <FontAwesomeIcon color=\"#de281b\" icon={['fas', 'times']} size=\"lg\" />;\r\n  const BubbleEmoji = <FontAwesomeIcon icon={['far', 'comment']} size=\"lg\" />;\r\n  const CheckEmoji = <FontAwesomeIcon color=\"#18ad1d\" icon={['fas', 'check']} size=\"lg\" />;\r\n\r\n  const GuessableView = (props: any) => {\r\n    const guessable: Guessable = props.guessable\r\n    const guess: GuessType = props.guess\r\n    if (guess.guessed) {\r\n      return <div className=\"pb-3\">\r\n        <div className=\"bt-orig\">{guess.guessedBy ? CheckEmoji : CrossEmoji} {guessable.original}</div>\r\n        <div className=\"bt-tg\">[<i>{guessable.toGuess}</i>]</div>\r\n        {guess.guessedBy && <div className=\"bt-gb\">{BubbleEmoji} {guess.guessedBy} <b>[+{guess.points}]</b></div>}\r\n      </div>\r\n    } else {\r\n      return <div className=\"pb-3\">\r\n        {CrossEmoji}<div className=\"bt-orig\" style={{ fontWeight: 'bold' }}>&nbsp;?</div>\r\n      </div>\r\n    }\r\n  }\r\n\r\n  const computeFlatScores = () => {\r\n    let flat: DisplayableScoreType[] = []\r\n    let distinctScores: number[] = [];\r\n    scores.forEach((_val: number, _key: string) => {\r\n      flat.push({\r\n        nick: _key,\r\n        score: _val\r\n      })\r\n      if (!distinctScores.includes(_val)) {\r\n        distinctScores.push(_val);\r\n      }\r\n    })\r\n    distinctScores.sort((a, b) => b - a);\r\n    flat.sort((a, b) => a.nick.localeCompare(b.nick))\r\n    flat.sort((a, b) => b.score - a.score)\r\n    if (nickFilter) {\r\n      flat = flat.filter(s => s.nick.toLowerCase().includes(nickFilter));\r\n    }\r\n    // Display rank only for the first of each group\r\n    for (let i = 0; i < flat.length; i++) {\r\n      if (i === 0 || flat[i].score !== flat[i - 1].score) {\r\n        flat[i].rank = 1 + distinctScores.indexOf(flat[i].score);\r\n      }\r\n    }\r\n    return flat;\r\n  }\r\n\r\n  return (\r\n    <div id=\"blindtest\">\r\n      <div className=\"row align-items-md-stretch mb-4\">\r\n        <div className=\"col-md-6\">\r\n          <div id=\"title\" className=\"p-3 mb-2 bg-light border rounded-3\" >\r\n            <div id=\"cover\">\r\n              {allGuessed() &&\r\n                <img id=\"cover-image\" src={coverUri} alt=\"album cover\" />\r\n              }\r\n              {(playing || loading) && !allGuessed() &&\r\n                <FontAwesomeIcon icon={['fas', 'question']} size=\"sm\" />\r\n              }\r\n              {!playing && !loading &&\r\n                <FontAwesomeIcon icon={['fas', 'volume-mute']} size=\"sm\" />\r\n              }\r\n            </div>\r\n          </div>\r\n          <div id=\"title\" className=\"p-3 mb-2 bg-light border rounded-3\" >\r\n            <div className=\"bt-h\">\r\n              <h2>TITLE</h2>\r\n            </div>\r\n            {playing &&\r\n              <div>\r\n                <GuessableView key=\"guess_0\" guessable={guessables[0]} guess={guesses[0]} />\r\n              </div>\r\n            }\r\n          </div>\r\n          <div id=\"artists\" className=\"p-3 mb-2 bg-light border rounded-3\" >\r\n            <div className=\"bt-h\">\r\n              <h2>ARTIST(S)</h2>\r\n            </div>\r\n            {playing &&\r\n              <div>\r\n                {guessables.slice(1).map((guessable: Guessable, index: number) => {\r\n                  return <GuessableView key={\"guess_\" + (index + 1)} guessable={guessable} guess={guesses[index + 1]} />\r\n                })}\r\n              </div>\r\n            }\r\n          </div>\r\n        </div>\r\n        <div className=\"col-md-6\">\r\n          <div id=\"player\" className=\"mb-2\" style={{ display: 'flex' }}>\r\n            <Button style={{ width: '30%' }} id=\"nextButton\" disabled={loading || doneTracks >= bt.tracks.length} type=\"submit\" variant=\"outline-secondary\" size=\"sm\" onClick={handleNextSong} title=\"Next\">\r\n              <FontAwesomeIcon icon={['fas', 'step-forward']} color=\"#84BD00\" size=\"sm\" /> NEXT\r\n            </Button>\r\n            &nbsp;\r\n            {\r\n              paused &&\r\n              <Button style={{ width: '30%' }} id=\"resumeButton\" disabled={!playing} type=\"submit\" variant=\"outline-secondary\" size=\"sm\" onClick={handleResume} title=\"Resume\">\r\n                <FontAwesomeIcon icon={['fas', 'play']} color=\"#84BD00\" size=\"sm\" /> RESUME\r\n              </Button>\r\n            }\r\n            {\r\n              !paused &&\r\n              <Button style={{ width: '30%' }} id=\"pauseButton\" disabled={!playing} type=\"submit\" variant=\"outline-secondary\" size=\"sm\" onClick={handlePause} title=\"Pause\">\r\n                <FontAwesomeIcon icon={['fas', 'pause']} color=\"#84BD00\" size=\"sm\" /> PAUSE\r\n              </Button>\r\n            }\r\n            &nbsp;\r\n            <Button style={{ width: '30%' }} id=\"revealButton\" disabled={!playing || allGuessed()} type=\"submit\" variant=\"outline-secondary\" size=\"sm\" onClick={handleReveal} title=\"Reveal\">\r\n              <FontAwesomeIcon icon={['fas', 'eye']} color=\"#84BD00\" size=\"sm\" /> REVEAL\r\n            </Button>\r\n            &nbsp;\r\n            <FormControl value={nickFilter} type=\"text\" role=\"searchbox\" placeholder=\"Nick filter\" size=\"sm\" onChange={(e) => setNickFilter(e.target.value.toLowerCase())} className=\"border\" />\r\n          </div>\r\n          <div id=\"leaderboard\" className=\"p-3 bg-light border rounded-3\">\r\n            <table className=\"table-hover bt-t\">\r\n              <thead>\r\n                <tr>\r\n                  <th style={{ width: \"60px\" }}>Rank</th>\r\n                  <th style={{ width: \"270px\" }}>Nick</th>\r\n                  <th style={{ width: \"60px\" }}>Score</th>\r\n                  <th style={{ width: \"100px\" }}></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {computeFlatScores().map((sc, index) => {\r\n                  return <tr key={\"score_\" + index}>\r\n                    <td>{sc.rank}</td>\r\n                    <td>{sc.nick}</td>\r\n                    <td>{sc.score}</td>\r\n                    <td className=\"text-right\">\r\n                      <Button type=\"submit\" variant=\"primary\" size=\"sm\" onClick={() => addPointToPlayer(sc.nick, -1)} className=\"text-nowrap\">\r\n                        <FontAwesomeIcon icon={['fas', 'minus']} size=\"sm\" />\r\n                      </Button>\r\n                      &nbsp;\r\n                      <Button type=\"submit\" variant=\"primary\" size=\"sm\" onClick={() => addPointToPlayer(sc.nick, 1)} className=\"text-nowrap\">\r\n                        <FontAwesomeIcon icon={['fas', 'plus']} size=\"sm\" />\r\n                      </Button>\r\n                    </td>\r\n                  </tr>\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BlindTestView\r\n","import { setAccessToken, setRefreshToken, getQueryParam } from \"helpers\"\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { retrieveAccessToken } from 'services/axios'\r\nimport { useContext, useEffect } from 'react'\r\nimport instance from \"../services/axios\";\r\nimport { BlindTestContext } from \"App\";\r\n\r\nconst LoginCallback = () => {\r\n\r\n  const { setLoggedIn } = useContext(BlindTestContext);\r\n  const navigate = useNavigate()\r\n\r\n  useEffect(() => {\r\n    const code = getQueryParam('code')\r\n    if (code) {\r\n      retrieveAccessToken(code).then(response => {\r\n        setRefreshToken(response.data.refresh_token);\r\n        const accessToken = response.data.access_token;\r\n        setAccessToken(accessToken);\r\n        instance.defaults.headers.common.Authorization = `Bearer ${accessToken}`;\r\n        setLoggedIn(true);\r\n        navigate(\"/\");\r\n      })\r\n    } else {\r\n      navigate(\"/\")\r\n    }\r\n  }, [navigate, setLoggedIn]);\r\n\r\n  return (\r\n    <div className=\"spinner\"></div>\r\n  )\r\n}\r\n\r\nexport default LoginCallback\r\n","import './App.scss';\r\nimport './icons';\r\nimport { useEffect, useState, createContext } from 'react';\r\nimport { Routes, Route, useNavigate } from 'react-router-dom';\r\nimport { Alert, Button } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { setAxiosErrorCallback } from './services/axios';\r\nimport { getRefreshToken, getSettings, hasStoredBlindTest } from './helpers';\r\nimport Login from './components/Login';\r\nimport Settings from './components/Settings';\r\nimport PlaylistTable from './components/PlaylistTable';\r\nimport PlaylistsButton from './components/PlaylistsButton';\r\nimport LogoutButton from './components/LogoutButton';\r\nimport SettingsButton from 'components/SettingsButton';\r\nimport BlindTestView from './components/BlindTestView';\r\nimport LoginCallback from './components/LoginCallback';\r\n\r\nfunction App() {\r\n  const navigate = useNavigate();\r\n\r\n  const [loggedIn, setLoggedIn] = useState(() => getRefreshToken() !== null);\r\n  const [configured, setConfigured] = useState(() => getSettings().isInitialized());\r\n  const [ongoingBt, setOngoingBt] = useState(() => hasStoredBlindTest());\r\n  const [view, setView] = useState(<div />);\r\n  const [subtitle, setSubtitle] = useState('');\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const contextValue = { loggedIn, setLoggedIn, configured, setConfigured, ongoingBt, setOngoingBt, subtitle, setSubtitle };\r\n\r\n  useEffect(() => {\r\n    setAxiosErrorCallback((msg: string) => { setErrorMessage(msg); });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!loggedIn) {\r\n      setView(<Login />);\r\n    } else if (!configured) {\r\n      navigate('/settings');\r\n    } else if (!ongoingBt) {\r\n      setView(<PlaylistTable />);\r\n    } else {\r\n      setView(<BlindTestView />);\r\n    }\r\n  }, [navigate, loggedIn, configured, ongoingBt]);\r\n\r\n  const onPopupClose = () => {\r\n    setErrorMessage('');\r\n    navigate('/');\r\n  };\r\n\r\n  return (\r\n    <BlindTestContext.Provider value={contextValue}>\r\n      <div className=\"App container\">\r\n        {errorMessage &&\r\n          <div className=\"spot-modal-bg\">\r\n            <Alert className=\"spot-modal\" variant=\"danger\" >\r\n              <Alert.Heading>Error</Alert.Heading>\r\n              <p>\r\n                Spotify server returned : {errorMessage}\r\n              </p>\r\n              <div className=\"d-flex justify-content-center\">\r\n                <Button onClick={onPopupClose} variant=\"outline-danger\">\r\n                  Close\r\n                </Button>\r\n              </div>\r\n            </Alert>\r\n          </div>\r\n        }\r\n        <header className=\"App-header\">\r\n          <div style={{ position: 'absolute', right: 0 }}>\r\n            {ongoingBt && <PlaylistsButton />}\r\n            {loggedIn && <SettingsButton />}\r\n            {loggedIn && <LogoutButton />}\r\n          </div>\r\n          <h1>\r\n            <FontAwesomeIcon icon={['fab', 'spotify']} color=\"#84BD00\" size=\"sm\" /> <a href={process.env.PUBLIC_URL}>BlindTesTwitch</a>\r\n          </h1>\r\n\r\n          <p id=\"subtitle\" className=\"lead text-secondary\">\r\n            {subtitle}\r\n          </p>\r\n        </header>\r\n        <Routes>\r\n          <Route path=\"/BlindTesTwitch\" element={view} />\r\n          <Route path=\"/BlindTesTwitch/callback\" element={<LoginCallback />} />\r\n          <Route path=\"/BlindTesTwitch/settings\" element={<Settings />} />\r\n        </Routes>\r\n      </div>\r\n    </BlindTestContext.Provider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\nexport const BlindTestContext = createContext({\r\n  loggedIn: false,\r\n  setLoggedIn: (v: boolean) => { }, // eslint-disable-line\r\n  configured: false,\r\n  setConfigured: (v: boolean) => { }, // eslint-disable-line\r\n  ongoingBt: false,\r\n  setOngoingBt: (v: boolean) => { }, // eslint-disable-line\r\n  subtitle: '',\r\n  setSubtitle: (v: string) => { } // eslint-disable-line\r\n});\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);  \r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n}\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\"\r\nimport ReactDOM from \"react-dom\"\r\nimport \"./index.scss\"\r\nimport App from \"./App\"\r\nimport reportWebVitals from \"./reportWebVitals\"\r\nimport { BrowserRouter } from \"react-router-dom\";\r\n\r\n// https://caniuse.com/mdn-javascript_builtins_array_flatmap\r\nrequire('array.prototype.flatmap').shim()\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <BrowserRouter>\r\n      <App />\r\n    </BrowserRouter>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}